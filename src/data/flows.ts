/**
 * Flow Definitions
 * Complete mapping of all user flows in the Ohouse AI application
 */

import { Flow, FlowAnalytics } from '../types/flows';

export const flows: Flow[] = [
  // ==================== HOME FLOW ====================
  {
    id: 'home-flow',
    name: 'Home & Discovery Flow',
    description: 'Browse design inspiration, filter content, and like images',
    status: 'complete',
    priority: 5,
    averageTime: '30 seconds - 5 minutes',
    completionRate: 'High',
    entryPoints: ['App launch', 'Click Home tab'],
    exitPoints: ['Navigate to creation flow', 'Switch to My Page', 'App close'],
    steps: [
      {
        id: 'home-1',
        title: 'View Home Screen',
        description: 'User sees feature cards and design feed',
        type: 'screen',
        hasBackButton: false,
        alternatives: 5, // 3 creation modes + My Page + Feed scroll
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['View', 'Scroll'],
      },
      {
        id: 'home-2',
        title: 'Browse Explore Feed',
        description: 'View 20 design images in grid layout',
        type: 'screen',
        hasBackButton: false,
        alternatives: 20, // Each image clickable
        friction: 'low',
        estimatedTime: '10-60 seconds',
        interactions: ['Scroll', 'View cards'],
      },
      {
        id: 'home-3',
        title: 'Apply Filters',
        description: 'Filter by Room Type, Style, or Budget',
        type: 'decision',
        hasBackButton: false,
        alternatives: 17, // 6 room types + 6 styles + 5 budgets
        friction: 'low',
        estimatedTime: '2-5 seconds',
        interactions: ['Click filter chip', 'Select option'],
      },
      {
        id: 'home-4',
        title: 'Like Images',
        description: 'Tap heart icon to favorite designs',
        type: 'action',
        hasBackButton: false,
        alternatives: 20, // Any feed image
        friction: 'low',
        estimatedTime: '1 second per image',
        interactions: ['Click heart icon'],
      },
    ],
    bottlenecks: [],
  },

  // ==================== PLACE OBJECT FLOW ====================
  {
    id: 'place-object-flow',
    name: 'Place Object Flow',
    description: 'Place furniture/objects in a room using AI',
    status: 'partial',
    priority: 5,
    averageTime: '15-30 seconds',
    completionRate: 'Medium',
    entryPoints: ['Click "Place an object" feature card'],
    exitPoints: [
      'Complete rendering request',
      'Click back button (state preserved)',
      'Navigate to My Page via queue indicator',
    ],
    steps: [
      {
        id: 'place-1',
        title: 'Click Feature Card',
        description: 'User selects "Place an object in your room"',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click card'],
      },
      {
        id: 'place-2',
        title: 'Select Space Type',
        description: 'Choose from 6 room categories',
        type: 'decision',
        hasBackButton: true,
        alternatives: 6, // Living Room, Bedroom, Kitchen, Bathroom, Dining Room, Office
        friction: 'low',
        estimatedTime: '2-5 seconds',
        interactions: ['Click space card', 'Go back'],
      },
      {
        id: 'place-3',
        title: 'Upload or Select Image',
        description: 'Upload custom image or choose from 3 examples',
        type: 'decision',
        hasBackButton: true,
        alternatives: 4, // Upload + 3 examples
        friction: 'medium',
        estimatedTime: '5-15 seconds',
        interactions: ['Click upload button', 'Select example', 'Go back'],
      },
      {
        id: 'place-4',
        title: 'AI Room Analysis',
        description: '3-step AI scanning process (9 seconds)',
        type: 'screen',
        hasBackButton: false,
        alternatives: 0, // No user control
        friction: 'high',
        estimatedTime: '9 seconds',
        interactions: ['Wait (locked)'],
      },
      {
        id: 'place-5',
        title: 'View Analysis Results',
        description: 'See product recommendations and render button',
        type: 'screen',
        hasBackButton: true,
        alternatives: 6, // Product chips + render button + back
        friction: 'low',
        estimatedTime: '5-30 seconds',
        interactions: ['View products', 'Click render', 'Go back'],
      },
      {
        id: 'place-6',
        title: 'Submit Rendering Request',
        description: 'Add to queue and navigate to My Page',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click button'],
      },
    ],
    bottlenecks: [
      {
        stepId: 'place-3',
        issue: 'Limited example images',
        severity: 'medium',
        suggestion: 'Provide more example images (6-9) to reduce upload friction',
        impact: 'Users may struggle to find suitable examples',
      },
      {
        stepId: 'place-4',
        issue: 'No cancel or back button during analysis',
        severity: 'high',
        suggestion: 'Add cancel/skip option during 9-second analysis',
        impact: 'Users are locked in with no escape',
      },
    ],
  },

  // ==================== INTERIOR DESIGN FLOW ====================
  {
    id: 'interior-design-flow',
    name: 'Interior Design Flow',
    description: 'Complete interior redesign using AI',
    status: 'partial',
    priority: 5,
    averageTime: '15-30 seconds',
    completionRate: 'Medium',
    entryPoints: ['Click "Overall Interior design" feature card'],
    exitPoints: [
      'Complete rendering request',
      'Click back button (state preserved)',
      'Navigate to My Page via queue indicator',
    ],
    steps: [
      {
        id: 'interior-1',
        title: 'Click Feature Card',
        description: 'User selects "Overall Interior design"',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click card'],
      },
      {
        id: 'interior-2',
        title: 'Select Space Type',
        description: 'Choose from 6 room categories',
        type: 'decision',
        hasBackButton: true,
        alternatives: 6,
        friction: 'low',
        estimatedTime: '2-5 seconds',
        interactions: ['Click space card', 'Go back'],
      },
      {
        id: 'interior-3',
        title: 'Upload or Select Image',
        description: 'Upload custom image or choose from 3 examples',
        type: 'decision',
        hasBackButton: true,
        alternatives: 4,
        friction: 'medium',
        estimatedTime: '5-15 seconds',
        interactions: ['Click upload button', 'Select example', 'Go back'],
      },
      {
        id: 'interior-4',
        title: 'AI Room Analysis',
        description: '3-step AI scanning process (9 seconds)',
        type: 'screen',
        hasBackButton: false,
        alternatives: 0,
        friction: 'high',
        estimatedTime: '9 seconds',
        interactions: ['Wait (locked)'],
      },
      {
        id: 'interior-5',
        title: 'View Analysis Results',
        description: 'See product recommendations and render button',
        type: 'screen',
        hasBackButton: true,
        alternatives: 6,
        friction: 'low',
        estimatedTime: '5-30 seconds',
        interactions: ['View products', 'Click render', 'Go back'],
      },
      {
        id: 'interior-6',
        title: 'Submit Rendering Request',
        description: 'Add to queue and navigate to My Page',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click button'],
      },
    ],
    bottlenecks: [
      {
        stepId: 'interior-3',
        issue: 'Limited example images',
        severity: 'medium',
        suggestion: 'Provide more example images (6-9)',
        impact: 'Users may struggle to find suitable examples',
      },
      {
        stepId: 'interior-4',
        issue: 'No cancel or back button during analysis',
        severity: 'high',
        suggestion: 'Add cancel/skip option during 9-second analysis',
        impact: 'Users are locked in with no escape',
      },
    ],
  },

  // ==================== EXTERIOR DESIGN FLOW ====================
  {
    id: 'exterior-design-flow',
    name: 'Exterior Design Flow',
    description: 'Exterior home redesign using AI',
    status: 'partial',
    priority: 4,
    averageTime: '15-30 seconds',
    completionRate: 'Medium',
    entryPoints: ['Click "Exterior design" feature card'],
    exitPoints: [
      'Complete rendering request',
      'Click back button (state preserved)',
      'Navigate to My Page via queue indicator',
    ],
    steps: [
      {
        id: 'exterior-1',
        title: 'Click Feature Card',
        description: 'User selects "Exterior design"',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click card'],
      },
      {
        id: 'exterior-2',
        title: 'Select Space Type',
        description: 'Choose from 6 room categories',
        type: 'decision',
        hasBackButton: true,
        alternatives: 6,
        friction: 'low',
        estimatedTime: '2-5 seconds',
        interactions: ['Click space card', 'Go back'],
      },
      {
        id: 'exterior-3',
        title: 'Upload or Select Image',
        description: 'Upload custom image or choose from 3 examples',
        type: 'decision',
        hasBackButton: true,
        alternatives: 4,
        friction: 'medium',
        estimatedTime: '5-15 seconds',
        interactions: ['Click upload button', 'Select example', 'Go back'],
      },
      {
        id: 'exterior-4',
        title: 'AI Room Analysis',
        description: '3-step AI scanning process (9 seconds)',
        type: 'screen',
        hasBackButton: false,
        alternatives: 0,
        friction: 'high',
        estimatedTime: '9 seconds',
        interactions: ['Wait (locked)'],
      },
      {
        id: 'exterior-5',
        title: 'View Analysis Results',
        description: 'See product recommendations and render button',
        type: 'screen',
        hasBackButton: true,
        alternatives: 6,
        friction: 'low',
        estimatedTime: '5-30 seconds',
        interactions: ['View products', 'Click render', 'Go back'],
      },
      {
        id: 'exterior-6',
        title: 'Submit Rendering Request',
        description: 'Add to queue and navigate to My Page',
        type: 'action',
        hasBackButton: false,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '1 second',
        interactions: ['Click button'],
      },
    ],
    bottlenecks: [
      {
        stepId: 'exterior-3',
        issue: 'Limited example images',
        severity: 'medium',
        suggestion: 'Provide more example images (6-9)',
        impact: 'Users may struggle to find suitable examples',
      },
      {
        stepId: 'exterior-4',
        issue: 'No cancel or back button during analysis',
        severity: 'high',
        suggestion: 'Add cancel/skip option during 9-second analysis',
        impact: 'Users are locked in with no escape',
      },
    ],
  },

  // ==================== MY PAGE FLOW ====================
  {
    id: 'mypage-flow',
    name: 'My Page Flow',
    description: 'View rendering queue and completed renders',
    status: 'partial',
    priority: 3,
    averageTime: '5-30 seconds',
    completionRate: 'High',
    entryPoints: [
      'Click My Page tab',
      'Click queue indicator (from creation flow)',
      'Auto-navigate after submitting render',
    ],
    exitPoints: ['Return to Home', 'Return to previous creation page', 'App close'],
    steps: [
      {
        id: 'mypage-1',
        title: 'View My Page Tab',
        description: 'See rendering queue and completed renders',
        type: 'screen',
        hasBackButton: true,
        alternatives: 2, // Back to home or back to previous page
        friction: 'low',
        estimatedTime: '2-10 seconds',
        interactions: ['View queue', 'View completed', 'Scroll'],
      },
      {
        id: 'mypage-2',
        title: 'Monitor Queue Progress',
        description: 'Watch rendering progress (5 seconds per render)',
        type: 'screen',
        hasBackButton: true,
        alternatives: 1,
        friction: 'low',
        estimatedTime: '5 seconds per item',
        interactions: ['Watch progress bar'],
      },
      {
        id: 'mypage-3',
        title: 'View Completed Renders',
        description: 'Browse finished AI-generated designs',
        type: 'screen',
        hasBackButton: true,
        alternatives: 0, // No actions defined yet
        friction: 'low',
        estimatedTime: '5-20 seconds',
        interactions: ['View results', 'Scroll'],
      },
    ],
    bottlenecks: [
      {
        stepId: 'mypage-1',
        issue: 'Inconsistent back button behavior',
        severity: 'medium',
        suggestion: 'Clarify navigation - should return to Home or previous creation page?',
        impact: 'Users may be confused about where "back" leads',
      },
      {
        stepId: 'mypage-3',
        issue: 'No actions on completed renders',
        severity: 'low',
        suggestion: 'Add share, download, or re-render options',
        impact: 'Limited usefulness after viewing results',
      },
    ],
  },
];

// ==================== ANALYTICS ====================
export const flowAnalytics: FlowAnalytics = {
  totalFlows: flows.length,
  totalSteps: flows.reduce((sum, flow) => sum + flow.steps.length, 0),
  entryPoints: flows.reduce((sum, flow) => sum + flow.entryPoints.length, 0),
  bottlenecks: flows.reduce((sum, flow) => sum + flow.bottlenecks.length, 0),
  deadEnds: 2, // Analysis screen (no cancel) + Completed renders (no actions)
  mostCommonPath: 'Home → Feature Card → Room Selection → Image Upload → Analysis → Results → Render',
  longestPath: 'Place Object Flow (6 steps)',
  shortestPath: 'Home Flow (4 steps)',
};
